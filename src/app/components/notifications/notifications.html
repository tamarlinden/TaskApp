<div class="notifications-container">
  <button class="notification-bell-btn" (click)="togglePanel()" title="Notifications">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
      <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
    </svg>
    @if (unreadCount() > 0) {
      <span class="notification-badge">{{ unreadCount() }}</span>
    }
  </button>

  @if (showPanel()) {
    <div class="notifications-panel animate-slideDown">
      <div class="panel-header">
        <h3>ğŸ“¬ ×”×ª×¨××•×ª</h3>
        @if (notifications().length > 0 && unreadCount() > 0) {
          <button class="mark-all-read-btn" (click)="markAllAsRead()">
            ×¡××Ÿ ×”×›×œ ×›× ×§×¨×
          </button>
        }
      </div>

      @if (isLoading()) {
        <div class="loading-state">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="spinner">
            <line x1="12" y1="2" x2="12" y2="6"></line>
            <line x1="12" y1="18" x2="12" y2="22"></line>
            <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line>
            <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line>
            <line x1="2" y1="12" x2="6" y2="12"></line>
            <line x1="18" y1="12" x2="22" y2="12"></line>
            <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line>
            <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>
          </svg>
          ×˜×•×¢×Ÿ ×”×ª×¨××•×ª...
        </div>
      } @else {
        <div class="notifications-list">
          @if (notifications().length > 0) {
            @for (notification of notifications(); track notification.id) {
              <div class="notification-item" [class.unread]="!notification.is_read" (click)="goToTask(notification)">
                <div class="notification-icon">
                  {{ getNotificationIcon(notification.type) }}
                </div>
                <div class="notification-content">
                  <div class="notification-title">
                    <strong>{{ notification.from_user_name }}</strong>
                    <span class="notification-type">{{ notification.type }}</span>
                  </div>
                  <div class="notification-message">
                    {{ notification.message }}
                  </div>
                  <div class="notification-time">
                    {{ formatDate(notification.created_at) }}
                  </div>
                </div>
                <button class="delete-btn" (click)="deleteNotification(notification.id, $event)" title="Delete">
                  âœ•
                </button>
              </div>
            }
          } @else {
            <div class="empty-state">
              <div class="empty-icon">ğŸ””</div>
              <p>××™×Ÿ ×”×ª×¨××•×ª</p>
              <small>×›×œ ×”×”×ª×¨××•×ª ×©×œ×š ×™×•×¤×™×¢×• ×›××Ÿ</small>
            </div>
          }
        </div>
      }
    </div>
  }
</div>
